# 软件体系结构文档模板

## 文档修改历史

|            修改人员            | 日期 | 修改原因             | 版本号 |
| :----------------------------: | ---- | -------------------- | ------ |
| 黄恺晟、杨承峰、李天宇、陈熠涛 | 5.1  | 拟定草稿             | v1.0   |
|             李天宇             | 6.17 | 添加第三阶段相关内容 | v2.0   |

## 目录
[TOC]


## 1.引言

### 		1.1 编制目的

​	本报告详细完成对连锁影院管理系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员以及用户的沟通。

​	本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

### 		1.2 词汇表

| 词汇名称 |   词汇含义   |  备注  |
| :------: | :----------: | :----: |
|   NJU    |   南京大学   |   无   |
|   _ui    | 表示某展示层 | ...... |
|   _bl    | 表示某业务层 | ...... |
|  _data   | 表示某数据层 | ...... |



### 		1.3 参考资料

​	1.IEEE std 1471-2000 

​	2.丁二玉，刘钦.计算与软件工程（卷二）[M]机械工业出版社，2012：134—182 

## 2.产品概述

​	参考NJU连锁院线用例文档和软件需求规格说明中队产品的概括描述

## 3.逻辑视图

​	连锁院线管理系统中，选择了分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层）能够很好地示意整个高层抽象。展示层包含web界面地实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。分层体系结构的逻辑视角和逻辑设计方案如图3-1和图3-2所示

​	

![icon](https://i.loli.net/2019/04/12/5cb064468167f.jpg)

​					图3-1 参照体系结构风格的包图表达逻辑视角

![icon](https://i.loli.net/2019/06/18/5d088fbab3fa293641.jpg)					



​				图3-2 软件体系结构逻辑设计方案

## 4.组合视图

### 		4.1 开发包图

​	连锁院线管理系统的最终开发包设计如表4-1所示

|     开发包开发包     | 依赖的其他开发包                                             |
| :------------------: | ------------------------------------------------------------ |
|         main         | audienceui、adminui、vo、movieInformationui、searchui、uploadmovieui |
|        userUI        | userService、界面类库包、vo、VUE框架                         |
|     statisticUI      | statisticService、界面类库包、vo、VUE框架                    |
|       movieUI        | movieService、界面类库包、vo、VUE框架                        |
|        hallUI        | hallService、界面类库包、vo、VUE框架                         |
|      scheduleUI      | scheduleService、界面类库包、vo、VUE框架                     |
|        VIPUI         | VIPService、界面类库包、vo、VUE框架                          |
|      activityUI      | activityService、界面类库包、vo、VUE框架                     |
|       couponUI       | couponService、界面类库包、vo、VUE框架                       |
|       recordUI       | recordService、界面类库包、vo、VUE框架                       |
|       salesUI        | salesService、界面类库包、vo、VUE框架                        |
|     userService      | userDataService、vo                                          |
|   statisticService   | statisticDataService、movieService、salesService、vo         |
|     movieService     | movieDataService、ArrayList、vo                              |
|     hallService      | hallDataService、scheduleService、vo                         |
|   scheduleService    | schedulDataService、hallService、vo                          |
|      VIPService      | VIPDataService、activityService、couponService、userService、recordService、vo |
|   activityService    | activityDataService、couponService、vo                       |
|    couponService     | couponDataService、vo                                        |
|    recordService     | recordDataService、VIPservice、ticketService、vo             |
|     salesService     | salesDataService、hallService、couponService、movieService、VIPservice、recordService、vo |
|   userDataService    | userservice、界面类库包、vo                                  |
| statisticDataService | po、Mysql、vo                                                |
|   movieDataService   | po、Mysql、vo                                                |
|   hallDataService    | po、Mysql、vo                                                |
| scheduleDataService  | po、Mysql、vo                                                |
|    VIPDataService    | po、Mysql、vo                                                |
| activityDataService  | po、Mysql、vo                                                |
|  couponDataService   | po、Mysql、vo                                                |
|  recordDataService   | po、Mysql、vo                                                |
|   salesDataService   | po、Mysql、vo                                                |
|       userData       | databaseutility、po、Mysql、vo                               |
|    statisticData     | databaseutility、po、Mysql、vo                               |
|      movieData       | databaseutility、po、Mysql、vo                               |
|       hallData       | databaseutility、po、Mysql、vo                               |
|     scheduleData     | databaseutility、po、Mysql、vo                               |
|       VIPData        | databaseutility、po、Mysql、vo                               |
|     activityData     | databaseutility、po、Mysql、vo                               |
|      couponData      | databaseutility、po、Mysql、vo                               |
|      recordData      | databaseutility、po、Mysql、vo                               |
|      salesData       | databaseutility、po、Mysql、vo                               |
![icon](https://i.loli.net/2019/06/18/5d088fbc2e26557428.jpg)



​		图4-1  连锁院线管理系统web端开发包图



![icon](https://s2.ax1x.com/2019/06/20/VxPqVe.png)

​			图4-2 连锁院线管理系统服务器端开发包图(其中mangement及promotion均为模块，具体细分略去)

### 		4.2 运行时进程

​	在连锁院线管理系统中，会有多个客户使用一个web端和一个服务器端相连。其进程如图4-3所示。结合部署图，web页面在客户机器上展示，服务器端进程在服务器端机器上运行

![icon](https://i.loli.net/2019/04/12/5cb06446e54f6.jpg)

### 4.3 物理部署

CINEMA系统中，客户经由浏览器通过URL访问，服务器端构件部署在服务器上，包括所有后端代码以及数据库。由于是web项目，客户直接通过浏览器访问网页，因此客户端不需要独立部署。部署图如图1所示。

![图1](https://i.loli.net/2019/04/19/5cb9753a4da63.jpg)



## 5.接口视角

### 5.1模块的职责

  客户端模块和服务器模块视图分布如图7和图8所示。客户端各层和服务端各层的职责分别如表2和表3所示。

![](https://i.loli.net/2019/04/19/5cb974cee8916.jpg)

​												图7

![](https://i.loli.net/2019/04/19/5cb974cf7521f.jpg)

​												图8

表2 客户端各层的职责

| 层             | 职责                                     |
| -------------- | ---------------------------------------- |
| 启动模块       | 负责初始化网络通信机制，启动用户界面     |
| 用户界面层     | 基于web的影院用户界面                    |
| 业务逻辑层     | 对于由用户端传来的数据及操作进行业务处理 |
| 客户端网络模块 | 利用http请求向服务器获取数据             |

表3 服务器端各层的职责

| 层               | 职责                                 |
| ---------------- | ------------------------------------ |
| 启动模块         | 负责初始化网络通信机制，启动用户界面 |
| 数据层           | 负责数据的持久化及数据访问接口       |
| 服务器端网络模块 | 对服务端发来的http请求处理回复       |

  每一层只是使用下方直接接触的层，层与层之间仅仅通过接口的调用来完成。层之间调用的接口如表4所示。

表4 层之间调用的接口

| 接口                                                         | 服务调用方       | 服务提供方       |
| ------------------------------------------------------------ | ---------------- | ---------------- |
| LoginBLService<br>MemberBLService<br>TicketBLService<br>MovieBLService<br>PromotionBLSerrvice<br>SaleBLService<br>StatisticBLService | 客户端展示层     | 客户端业务逻辑层 |
| UserDataService<br>MemberDataService<br>TicketDataService<br>MovieDataService<br>PromotionDataService<br>SaleDataService<br>StatisticDataService<br>DatabaseFactory | 客户端业务逻辑层 | 服务器端数据层   |



### 5.2用户界面层的分解

  根据需求，系统存在以下界面。其中影院员工和用户访问的电影列表界面及电影详情界面可复用，未登录时亦可访问该界面。![](https://i.loli.net/2019/04/19/5cb974d0de486.jpg)

#### 5.2.1用户界面层主要组件的构成和职责

| 组件         | 职责                                     |
| ------------ | ---------------------------------------- |
| MainFrame    | 作为容器用于显示子组件                   |
| MovieDetail  | 用于展示电影详情                         |
| MovieLIst    | 显示电影列表                             |
| OrderTicket  | 用于显示选择电影的上座情况并提供选座功能 |
| BillHIstory  | 用于显示账单历史                         |
| DataAnalysis | 用于展示选择电影的统计分析数据           |
| PutAwayMovie | 用于输入信息上架电影                     |
| UserCenter   | 用于管理用户信息和会员卡信息             |

#### 5.2.2用户界面层组件所依赖的主要服务

​	用户界面视图组件本身不需要提供接口，视图逻辑由视图本身提供。只需依赖后端服务器提供接口进行数据处理。下表提供本阶段所需的主要接口

| 服务名                   | 服务                             |
| ------------------------ | -------------------------------- |
| LoginService             | 登陆界面业务逻辑接口             |
| RegisterService          | 注册界面业务逻辑接口             |
| MovieinfoService.list    | 提供电影列表展示信息             |
| MovieInfoService.detail  | 提供单个电影详细信息             |
| MovieinfoService.putAway | 上架电影                         |
| OrderTicketService.Info  | 提供单个电影某个场次选座情况     |
| OrderTicketService.order | 对单个电影某个场次进行选择购票   |
| CinemaService.*Blservice | 对排片信息进行相应的增删改查操作 |

#### 5.2.3

​	用户界面利用Vue框架及iview、elment等ui组件库实现5.3  业务逻辑层分解

​	业务逻辑层包括多个针对页面的业务逻辑处理对象。例如，audience对象负责处理观众登陆界面的业务逻辑；admin对象负责处理管理员登陆界面的业务逻辑。业务逻辑层的设计图如5.3-1所示。

![icon](https://i.loli.net/2019/06/17/5d076dbb17f7e29431.jpg)



###5.3 业务逻辑层分解

#### 				5.3.1 职责

业务逻辑层模块的指责如表所示

​						表1  		业务逻辑层模块的职责

|  模     块   |                           职    责                           |
| :----------: | :----------------------------------------------------------: |
|    userbl    |      负责实现用户注册登录以及影院员工增删改查相关的服务      |
| managementbl |       负责实现影院日常管理如影厅、电影、排片相关的服务       |
|   salesbl    |              负责实现票务销售及退改票相关的服务              |
| promotionbl  | 负责实现影院优惠方面如vip、日常活动、优惠券的分发使用所需要的服务 |
| statisticbl  |             负责实现影院数据统计方面所需要的服务             |
|   recordbl   |              负责实现用户充值消费记录相关的服务              |
|    bankbl    |                   负责银行卡支付相关的服务                   |



#### 				5.3.2接口规范

##### userbl模块的接口和规范如表所示

|            | 提供的服务（供接口） |                                                     |
| ---------- | -------------------- | --------------------------------------------------- |
|            | 语法                 | public ResultMessage login(int id,String password); |
| user.login | 前置条件             | password 符合输入规则                               |
|            | 后置条件             | 查找是否存在相应的用户，根据输入的password返回结果  |

|              需要的服务               |           （需接口）           |
| :-----------------------------------: | :----------------------------: |
|              **服务名**               |            **服务**            |
|    DatabaseFacory.getUserDatabase     | 得到audience数据库的服务的印用 |
| audienceDataservice.insert(UserPo po) |   在audience数据库插入PO对象   |

|             | 提供的服务（供接口） |                                           |
| ----------- | -------------------- | ----------------------------------------- |
|             | 语法                 | public ResultMessage delete(int userId);  |
| user.delete | 前置条件             | 操作人员为管理员且userlevel高于被操作员工 |
|             | 后置条件             | 查找是否存在相应的用户并更新相应的信息    |

|             需要的服务             |         （需接口）          |
| :--------------------------------: | :-------------------------: |
|             **服务名**             |          **服务**           |
|   DatabaseFacory.getUserDatabase   | 得到admin数据库的服务的印用 |
| adminDataservice.delete(UserPo po) |    在user数据库删除数据     |


|             | 提供的服务（供接口） |                                        |
| ----------- | -------------------- | -------------------------------------- |
|             | 语法                 | public ResultMessage update(userForm); |
| user.update | 前置条件             | 操作人员为管理员                       |
|             | 后置条件             | 查找是否存在相应的用户并更新相应的信息 |

|             需要的服务             |         （需接口）          |
| :--------------------------------: | :-------------------------: |
|             **服务名**             |          **服务**           |
|   DatabaseFacory.getUserDatabase   | 得到admin数据库的服务的印用 |
| adminDataservice.update(UserPo po) |       更新数据库数据        |



| AccountServiceImpl.registerAccount | 语法     | public ResponseVO registerAccount( UserForm userForm) |
| ---------------------------------- | -------- | ----------------------------------------------------- |
|                                    | 前置条件 |                                                       |
|                                    | 后置条件 | 更新用户信息                                          |



| AccountServiceImpl.logOut | 语法     | public ResponseVO logOut( HttpSession session) |
| ------------------------- | -------- | ---------------------------------------------- |
|                           | 前置条件 |                                                |
|                           | 后置条件 | 清除session中信息                              |



| AccountServiceImpl.addStaff | 语法     | public ResponseVO addStaff( UserForm userForm) |
| --------------------------- | -------- | ---------------------------------------------- |
|                             | 前置条件 |                                                |
|                             | 后置条件 | 更新用户信息                                   |



| AccountServiceImpl.searchAllStaff | 语法     | public ResponseVO searchAllStaff( ) |
| --------------------------------- | -------- | ----------------------------------- |
|                                   | 前置条件 |                                     |
|                                   | 后置条件 |                                     |



| AccountServiceImpl.getStaffInfoById | 语法     | public ResponseVO getStaffInfoById(int staffId) |
| ----------------------------------- | -------- | ----------------------------------------------- |
|                                     | 前置条件 |                                                 |
|                                     | 后置条件 |                                                 |


##### statistic模块的接口和规范如表所示

| StatisticsService.getScheduleRateByDate | 语法     | public ResponseVO getScheduleRateByDate(Date date) |
| --------------------------------------- | -------- | -------------------------------------------------- |
|                                         | 前置条件 |                                                    |
|                                         | 后置条件 |                                                    |

| StatisticsService.getTotalBoxOffice | 语法     | public ResponseVO getTotalBoxOffice() |
| ----------------------------------- | -------- | ------------------------------------- |
|                                     | 前置条件 |                                       |
|                                     | 后置条件 |                                       |

| StatisticsService.getAudiencePriceSevenDays | 语法     | public ResponseVO getAudiencePriceSevenDays(Date date) |
| ------------------------------------------- | -------- | ------------------------------------------------------ |
|                                             | 前置条件 |                                                        |
|                                             | 后置条件 |                                                        |

| StatisticsService.getMoviePlacingRateByDate | 语法     | public ResponseVO getMoviePlacingRateByDate(Date date) |
| ------------------------------------------- | -------- | ------------------------------------------------------ |
|                                             | 前置条件 |                                                        |
|                                             | 后置条件 |                                                        |

| StatisticsService.getPopularMovies | 语法     | public ResponseVO getPopularMovies(int days, int movieNum) |
| ---------------------------------- | -------- | ---------------------------------------------------------- |
|                                    | 前置条件 |                                                            |
|                                    | 后置条件 |                                                            |


#####managementbl模块的接口和规范如表所示

|              | 提供的服务（供接口） |                                                      |
| ------------ | -------------------- | ---------------------------------------------------- |
|              | 语法                 | public ResultMessage movieBrowse(String movieName);  |
| movie.browse | 前置条件             | movieName 符合输入规则                               |
|              | 后置条件             | 查找是否存在相应的movie，根据输入的movieName返回结果 |

|           需要的服务            |          （需接口）          |
| :-----------------------------: | :--------------------------: |
|           **服务名**            |           **服务**           |
| DatabaseFacory.getMovieDatabase | 得到 movie数据库的服务的印用 |
|     movieDataservice.update     | 修改movie数据库中的电影信息  |

|              | 提供的服务（供接口） |                                                        |
| ------------ | -------------------- | ------------------------------------------------------ |
|              | 语法                 | public ResultMessage movieUpload(MovieForm movieForm); |
| movie.upload | 前置条件             | 操作人员为管理员                                       |
|              | 后置条件             | 更新数据库信息                                         |

|           需要的服务            |          （需接口）          |
| :-----------------------------: | :--------------------------: |
|           **服务名**            |           **服务**           |
| DatabaseFacory.getMovieDatabase | 得到 movie数据库的服务的印用 |
|     movieDataservice.insert     | 向movie数据库中添加电影信息  |

|              | 提供的服务（供接口） |                                                |
| ------------ | -------------------- | ---------------------------------------------- |
|              | 语法                 | public ResultMessage movieDelete(int movieId); |
| movie.delete | 前置条件             | 操作人员为管理员                               |
|              | 后置条件             | 查找是否存在相应的movie，删除后更新信息        |

|           需要的服务            |          （需接口）          |
| :-----------------------------: | :--------------------------: |
|           **服务名**            |           **服务**           |
| DatabaseFacory.getMovieDatabase | 得到 movie数据库的服务的印用 |
|     movieDataservice.delete     | 删除movie数据库中的电影信息  |



#####salebl模块的接口和规范如表所示

|                  | 提供的服务（供接口） |                                                        |
| ---------------- | -------------------- | ------------------------------------------------------ |
|                  | 语法                 | public ResultMessage addTicket(TicketForm ticketForm); |
| ticket.addticket | 前置条件             | 用户已登陆且所选座位为空                               |
|                  | 后置条件             | 修改数据库信息                                         |

|             需要的服务             |           （需接口）           |
| :--------------------------------: | :----------------------------: |
|             **服务名**             |            **服务**            |
| DatabaseFacory.getAudienceDatabase | 得到audience数据库的服务的印用 |
|    ticketDataService.addticket     |  在ticket数据库中插入订单信息  |


|               | 提供的服务（供接口） |                                                            |
| ------------- | -------------------- | ---------------------------------------------------------- |
|               | 语法                 | public ResultMessage ticketRefund（TicketForm ticketForm); |
| ticket.refund | 前置条件             | 用户已登陆，且所退票可退                                   |
|               | 后置条件             | 修改数据库信息                                             |

|             需要的服务             |              （需接口）              |
| :--------------------------------: | :----------------------------------: |
|             **服务名**             |               **服务**               |
| DatabaseFacory.getAudienceDatabase |    得到audience数据库的服务的印用    |
|       ticketDataService.buy        | 在ticket数据库中寻找对应数据进行修改 |

|                       | 提供的服务（供接口） |                                                             |
| --------------------- | -------------------- | ----------------------------------------------------------- |
|                       | 语法                 | public ResultMessage completeTicket(TicketForm ticketForm); |
| ticket.completeTicket | 前置条件             | 已锁座且未支付                                              |
|                       | 后置条件             | 修改数据库信息为已支付                                      |

|             需要的服务             |              （需接口）              |
| :--------------------------------: | :----------------------------------: |
|             **服务名**             |               **服务**               |
| DatabaseFacory.getAudienceDatabase |    得到audience数据库的服务的印用    |
|  ticketDataService.completeTicket  | 在ticket数据库中寻找对应数据进行修改 |


| ticketServiceImpl.buyTicketByVIPCard | 语法     | public ResponseVO buyTicketByVIPCard(List\<Integer\> ticketId, int couponId) |
| ------------------------------------ | -------- | ------------------------------------------------------------ |
|                                      | 前置条件 |                                                              |
|                                      | 后置条件 | 更新相关订单和票数据                                         |


| ticketServiceImpl.getTicketByUserId | 语法     | public ResponseVO getTicketByUserId(int userId) |
| ----------------------------------- | -------- | ----------------------------------------------- |
|                                     | 前置条件 |                                                 |
|                                     | 后置条件 |                                                 |

| ticketServiceImpl.getTicketByOrderID | 语法     | public ResponseVO getTicketByOrderID(int orderID) |
| ------------------------------------ | -------- | ------------------------------------------------- |
|                                      | 前置条件 |                                                   |
|                                      | 后置条件 |                                                   |

| ticketServiceImpl.getOccupiedSeats | 语法     | public ResponseVO getOccupiedSeats(int scheduleId) |
| ---------------------------------- | -------- | -------------------------------------------------- |
|                                    | 前置条件 |                                                    |
|                                    | 后置条件 |                                                    |


| ticketServiceImpl.addRefundStrategy | 语法     | public ResponseVO addRefundStrategy(RefundStrategyForm refundStrategyForm) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 | 更新退款政策数据                                             |

| ticketServiceImpl.updateRefundStrategy | 语法     | public ResponseVO updateRefundStrategy(RefundStrategyForm refundStrategyForm) |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
|                                        | 前置条件 |                                                              |
|                                        | 后置条件 | 更新退款政策数据                                             |

| ticketServiceImpl.showAllRefundStrategy | 语法     | public ResponseVO showAllRefundStrategy() |
| --------------------------------------- | -------- | ----------------------------------------- |
|                                         | 前置条件 |                                           |
|                                         | 后置条件 |                                           |

| ticketServiceImpl.useRefundStrategy | 语法     | public ResponseVO useRefundStrategy(int id) |
| ----------------------------------- | -------- | ------------------------------------------- |
|                                     | 前置条件 |                                             |
|                                     | 后置条件 | 更新退款政策数据                            |


#####promotion模块的接口和规范如表所示



#####promotion.vipcard模块的接口和规范如表所示

| VIPcardServiceImpl.addVIPCard() | 语法     | public ResponseVO addVIPCard(int userId,BankCardForm bankCardForm) |
| ------------------------------------ | -------- | ------------------------------------------------------------ |
|                                      | 前置条件 |                                                              |
|                                      | 后置条件 |                                                              |

|            需要的服务            |         （需接口）          |
| :------------------------------: | :-------------------------: |
|            **服务名**            |          **服务**           |
|  DatabaseFacory.getUserDatabase  | 得到admin数据库的服务的印用 |
| VIPDataservice.update(UserPo po) |       更新数据库数据        |

| VIPcardServiceImpl.getCardById() | 语法     |  public ResponseVO getCardById(int id) |
| -------------------------- | -------- | ------------------------------------------------- |
|                            | 前置条件 |                                                   |
|                            | 后置条件 |                                                   |

| VIPcardServiceImpl.getVIPInfo() | 语法     | public ResponseVO getVIPInfo()  |
| --------------------------- | -------- | ------------------------------------------------------------ |
|                             | 前置条件 |                                                              |
|                             | 后置条件 |                                                              |

| VIPcardServiceImpl.charge() | 语法     | public ResponseVO charge(VIPchargeVO viPchargeVO) |
| ----------------------------------- | -------- | ----------------------------------------------- |
|                                     | 前置条件 |                                                 |
|                                     | 后置条件 |                                                 |

| VIPcardServiceImpl.refund() | 语法     | public ResponseVO refund(VIPCardForm vipCardForm) |
| ------------------------------------ | -------- | ------------------------------------------------- |
|                                      | 前置条件 |                                                   |
|                                      | 后置条件 |                                                   |

| VIPcardServiceImpl.getCardByUserId() | 语法     | public ResponseVO getCardByUserId(int userId)  |
| ---------------------------------- | -------- | -------------------------------------------------- |
|                                    | 前置条件 |                                                    |
|                                    | 后置条件 |                                                    |

| VIPcardServiceImpl.cardBuy() | 语法     |  public ResponseVO cardBuy(VIPCardForm vipCardForm) |
| ------------------------------ | -------- | ------------------------------------------------------ |
|                                | 前置条件 |                                                        |
|                                | 后置条件 |                                                        |

| VIPcardServiceImpl.addVIPDiscountStrategy() | 语法     |  public     ResponseVO addVIPDiscountStrategy(int quota,int gift) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 |                                                              |

| VIPcardServiceImpl.getDiscountStrategy() | 语法     |public ResponseVO getDiscountStrategy() |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
|                                        | 前置条件 |                                                              |
|                                        | 后置条件 |                                                              |


| VIPcardServiceImpl.deleteDiscountStrategy() | 语法     |  public ResponseVO deleteDiscountStrategy(int strategyID) |
| ----------------------------------- | -------- | ------------------------------------------- |
|                                     | 前置条件 |                                             |
|                                     | 后置条件 |                                             |

| VIPcardServiceImpl.getUserByAmount() | 语法     |   public ResponseVO getUserByAmount(int amount) |
| ----------------------------------- | -------- | ------------------------------------------- |
|                                     | 前置条件 |                                             |
|                                     | 后置条件 |                                             |

| VIPcardServiceImpl.giveCoupon() | 语法     |  public ResponseVO giveCoupon(GiveCouponVO giveCouponVO) |
| ----------------------------------- | -------- | ------------------------------------------- |
|                                     | 前置条件 |                                             |
|                                     | 后置条件 |                                             |

AccountController依赖AccountServiceImpl提供的接口；AccountServiceImpl依赖AccountMapper提供的接口

#####promotion.coupon模块的接口和规范如表所示


| CouponServiceImpl.getCouponsByUser| 语法     | public ResponseVO getCouponsByUser(int userId) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |          |



| CouponServiceImpl.addCoupon| 语法     | public ResponseVO addCoupon(CouponForm couponForm) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |

|             需要的服务              |           （需接口）           |
| :---------------------------------: | :----------------------------: |
|             **服务名**              |            **服务**            |
|   DatabaseFacory.getUserDatabase    | 得到audience数据库的服务的印用 |
| couponDataservice.insert(Coupon coupon) |    在coupon数据库插入PO对象    |



| CouponServiceImpl.issueCoupon | 语法     | public ResponseVO issueCoupon(int couponId,int userId); |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |




| CouponServiceImpl.usedCoupon| 语法     | public ResponseVO usedCoupon(int couponId,int userId); |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |


|             需要的服务             |         （需接口）          |
| :--------------------------------: | :-------------------------: |
|             **服务名**             |          **服务**           |
|   DatabaseFacory.getUserDatabase   | 得到admin数据库的服务的印用 |
| adminDataservice.delete(Coupon coupon) |    在user数据库删除数据     |


| CouponServiceImpl.getCouponById| 语法     | public Coupon getCouponById(int couponId); |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |

#####promotion.activity模块的接口和规范如表所示


| ActivityServiceImpl.publishActivity| 语法     | public ResponseVO publishActivity(ActivityForm activityForm) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |          |



| ActivityServiceImpl.getActivities()| 语法     | public ResponseVO getActivities(); |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |



| ActivityServiceImpl.getActivityById| 语法     | public ResponseVO getActivityById(int id) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |


#####management.movie模块的接口和规范如表所示

| movieServiceImpl.addMovie | 语法     | public ResponseVO addMovie(MovieForm addMovieForm) |
| ------------------------- | -------- | -------------------------------------------------- |
|                           | 前置条件 |                                                    |
|                           | 后置条件 | 更新电影数据                                       |

| movieServiceImpl.searchOneMovieByIdAndUserId | 语法     | public ResponseVO searchOneMovieByIdAndUserId(int id, int userId) |
| -------------------------------------------- | -------- | ------------------------------------------------------------ |
|                                              | 前置条件 |                                                              |
|                                              | 后置条件 |                                                              |

| movieServiceImpl.searchAllMovie | 语法public ResponseVO searchAllMovie() |      |
| ------------------------------- | -------------------------------------- | ---- |
|                                 | 前置条件                               |      |
|                                 | 后置条件                               |      |

| movieServiceImpl.searchOtherMoviesExcludeOff | 语法     | public ResponseVO searchOtherMoviesExcludeOff() |
| -------------------------------------------- | -------- | ----------------------------------------------- |
|                                              | 前置条件 |                                                 |
|                                              | 后置条件 |                                                 |

| movieServiceImpl.getMovieByKeyword | 语法     | public ResponseVO getMovieByKeyword(String keyword) |
| ---------------------------------- | -------- | --------------------------------------------------- |
|                                    | 前置条件 |                                                     |
|                                    | 后置条件 |                                                     |

| movieServiceImpl.pullOfBatchOfMovie | 语法     | public ResponseVO pullOfBatchOfMovie(MovieBatchOffForm movieBatchOffForm) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 | 更新电影数据                                                 |

| movieServiceImpl.updateMovie | 语法     | public ResponseVO updateMovie(MovieForm movieUpdateForm) |
| ---------------------------- | -------- | -------------------------------------------------------- |
|                              | 前置条件 |                                                          |
|                              | 后置条件 | 更新电影数据                                             |

| movieServiceImpl.getMovieById | 语法     | public ResponseVO getMovieById(int movieId) |
| ----------------------------- | -------- | ------------------------------------------- |
|                               | 前置条件 |                                             |
|                               | 后置条件 |                                             |

其中给MovieById实现了MovieServiceForBl的接口



#####management.schedule模块的接口和规范如表所示

| scheduleServiceImpl.addSchedule | 语法     | public ResponseVO addSchedule(SchdeuleForm scheduleForm) |
| ------------------------------- | -------- | -------------------------------------------------------- |
|                                 | 前置条件 |                                                          |
|                                 | 后置条件 | 更新排片数据                                             |

| scheduleServiceImpl.updateSchedule | 语法     | public ResponseVO updateSchedule(SchdeuleForm scheduleForm) |
| ---------------------------------- | -------- | ----------------------------------------------------------- |
|                                    | 前置条件 |                                                             |
|                                    | 后置条件 | 更新排片数据                                                |

| scheduleServiceImpl.searchScheduleSevenDays | 语法     | public ResponseVO searchScheduleSevenDays(int hallId, Date startDate) |
| ------------------------------------------- | -------- | ------------------------------------------------------------ |
|                                             | 前置条件 |                                                              |
|                                             | 后置条件 |                                                              |

| scheduleServiceImpl.searchAudienceSchedule | 语法     | public ResponseVO searchAudienceSchedule(int movieId) |
| ------------------------------------------ | -------- | ----------------------------------------------------- |
|                                            | 前置条件 |                                                       |
|                                            | 后置条件 |                                                       |

| scheduleServiceImpl.setScheduleView | 语法     | public ResponseVO setScheduleView(ScheduleViewForm scheduleViewForm) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 | 更新排片设置数据                                             |

| scheduleServiceImpl.getScheduleView | 语法     | public ResponseVO getScheduleView() |
| ----------------------------------- | -------- | ----------------------------------- |
|                                     | 前置条件 |                                     |
|                                     | 后置条件 |                                     |

| scheduleServiceImpl.deleteBatchOfSchedule | 语法     | public ResponseVO deleteBatchOfSchedule(ScheduleBatchDeleteForm scheduleBatchDeleteForm) |
| ----------------------------------------- | -------- | ------------------------------------------------------------ |
|                                           | 前置条件 |                                                              |
|                                           | 后置条件 | 更新排片数据                                                 |

| scheduleServiceImpl.getScheduleById | 语法     | public ResponseVO getScheduleById(int id) |
| ----------------------------------- | -------- | ----------------------------------------- |
|                                     | 前置条件 |                                           |
|                                     | 后置条件 |                                           |

| scheduleServiceImpl.getScheduleItemById | 语法     | public ResponseVO getScheduleItemById(int id) |
| --------------------------------------- | -------- | --------------------------------------------- |
|                                         | 前置条件 |                                               |
|                                         | 后置条件 |                                               |

| scheduleServiceImpl.getScheduleByMovieIdList | 语法     | public ResponseVO getScheduleByMovieIdList(List movieList) |
| -------------------------------------------- | -------- | ---------------------------------------------------------- |
|                                              | 前置条件 |                                                            |
|                                              | 后置条件 |                                                            |

其中getScheduleByMovieIdList和getScheduleItemById实现scheduleServiceForBl的接口



#####management.hall模块的接口和规范如表所示

| hallServiceImpl.searchAllHall | 语法     | public ResponseVO searchAllHall() |
| ----------------------------- | -------- | --------------------------------- |
|                               | 前置条件 |                                   |
|                               | 后置条件 |                                   |

| hallServiceImpl.addHall | 语法     | public ResponseVO addHall(HallInfoFrom hallInfoForm) |
| ----------------------- | -------- | ---------------------------------------------------- |
|                         | 前置条件 |                                                      |
|                         | 后置条件 | 更新影厅数据                                         |

| hallServiceImpl.changeHallInfo | 语法     | public ResponseVO changeHallInfo(HallVO hallVO) |
| ------------------------------ | -------- | ----------------------------------------------- |
|                                | 前置条件 |                                                 |
|                                | 后置条件 | 更新影厅数据                                    |

| hallServiceImpl.deleteHallInfo | 语法     | public ResponseVO deleteHallInfo(int id) |
| ------------------------------ | -------- | ---------------------------------------- |
|                                | 前置条件 |                                          |
|                                | 后置条件 | 更新影厅数据                             |

| hallServiceImpl.getHallById | 语法     | public ResponseVO getHallById(int id) |
| --------------------------- | -------- | ------------------------------------- |
|                             | 前置条件 |                                       |
|                             | 后置条件 |                                       |






### 		5.4 数据层分解

数据层主要给业务逻辑层提供数据访问服务，包括对于持久化数据的增、删、改、查。    User业务逻辑需要的服务由UserDataService接口提供；MovieInformation业务逻辑需要的服务由MovieDataService接口提供;Ticket业务逻辑需要的服务由TicketDataService接口提供；ScheduleArrange业务逻辑需要的服务由SADataService接口提供；VIP业务逻辑需要的服务由VIPDataService接口提供。由于持久化数据的保存可能存在多种形式：序列化文件、数据库等，所示抽象了数据服务。数据层模块的描述具体如图所示。

![icon](https://i.loli.net/2019/04/19/5cb97ff8d5643.jpg)

#### 				5.4.1 职责

数据层模块的指责如表所示。

| 模块                                    | 职责                                                         |
| --------------------------------------- | ------------------------------------------------------------ |
| UserDataService                     | 持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| UserDataServiceSerializableFileImpl | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| UserDataServiceMySqlImpl                     | 基于MySQL数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| MovieDataService                        | 持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| MovieDataServiceSerializableFileImpl    | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| MovieDataServiceMySqlImpl                        | 基于MySQL数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| TicketDataService                        | 持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| TicketServiceSerializableFileImpl    | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| TicketServiceMySqlImpl                        | 基于MySQL数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| SCDataService                        | 持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| SCServiceSerializableFileImpl    | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| SCServiceMySqlImpl                        | 基于MySQL数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| VIPDataService                        | 持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| VIPServiceSerializableFileImpl    | 基于序列化文件的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |
| VIPServiceMySqlImpl                        | 基于MySQL数据库的持久化数据库的接口，提供集体载入、集体保存、增、删、改、查服务 |

#### 

#### 				5.4.2接口规范

数据层模块的接口规范如表所示
<table width="1440" border="0" cellpadding="0" cellspacing="0" style='width:864.00pt;border-collapse:collapse;table-layout:fixed;'>
   <col width="90" span="16" style='width:54.00pt;'/>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="26" width="990" colspan="11" style='height:15.60pt;width:594.00pt;border-right:none;border-bottom:none;' x:str>提供的服务（供接口）</td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>UserDataService.find</td>
    <td x:str>语法</td>
    <td class="xl66" colspan="6" style='mso-ignore:colspan;' x:str>public UserPO find(long id)throws<span style='mso-spacerun:yes;'>&nbsp; </span>RemoteException</td>
    <td class="xl66"></td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>按ID进行查找返回相应的UserPO结果</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>UserDataService.insert</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void insert(UserPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>同样ID的po在mapper中不存在</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中增加一个po记录</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>UserDataService.delete</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void delete(UserPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>删除一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>UserDataService.update</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void update(UserPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>更新一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>UserDataService.init</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void init() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>初始化持久化数据库</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>UserDataService.finish</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void finish() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>结束持久化数据库的使用</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <![if supportMisalignedColumns]>
    <tr width="0" style='display:none;'/>
   <![endif]>
  </table>

<table width="1440" border="0" cellpadding="0" cellspacing="0" style='width:864.00pt;border-collapse:collapse;table-layout:fixed;'>
   <col width="90" span="16" style='width:54.00pt;'/>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="26" width="990" colspan="11" style='height:15.60pt;width:594.00pt;border-right:none;border-bottom:none;' x:str>提供的服务（供接口）</td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>MovieDataService.find</td>
    <td x:str>语法</td>
    <td class="xl66" colspan="6" style='mso-ignore:colspan;' x:str>public MoviePO find(long id)throws<span style='mso-spacerun:yes;'>&nbsp; </span>RemoteException</td>
    <td class="xl66"></td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>按ID进行查找返回相应的MoviePO结果</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>MovieDataService.insert</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void insert(MoviePO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>同样ID的po在mapper中不存在</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中增加一个po记录</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>MovieDataService.delete</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void delete(MoviePO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>删除一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>MovieDataService.update</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void update(MoviePO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>更新一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>MovieDataService.init</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void init() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>初始化持久化数据库</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>MovieDataService.finish</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void finish() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>结束持久化数据库的使用</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <![if supportMisalignedColumns]>
    <tr width="0" style='display:none;'/>
   <![endif]>
  </table>

<table width="1440" border="0" cellpadding="0" cellspacing="0" style='width:864.00pt;border-collapse:collapse;table-layout:fixed;'>
   <col width="90" span="16" style='width:54.00pt;'/>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="26" width="990" colspan="11" style='height:15.60pt;width:594.00pt;border-right:none;border-bottom:none;' x:str>提供的服务（供接口）</td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>TicketDataService.find</td>
    <td x:str>语法</td>
    <td class="xl66" colspan="6" style='mso-ignore:colspan;' x:str>public TicketPO find(long id)throws<span style='mso-spacerun:yes;'>&nbsp; </span>RemoteException</td>
    <td class="xl66"></td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>按ID进行查找返回相应的TicketPO结果</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>TicketDataService.insert</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void insert(TicketPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>同样ID的po在mapper中不存在</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中增加一个po记录</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>TicketDataService.delete</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void delete(TicketPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>删除一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>TicketDataService.update</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void update(TicketPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>更新一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>TicketDataService.init</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void init() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>初始化持久化数据库</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>TicketDataService.finish</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void finish() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>结束持久化数据库的使用</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <![if supportMisalignedColumns]>
    <tr width="0" style='display:none;'/>
   <![endif]>
  </table> 

  <table width="1440" border="0" cellpadding="0" cellspacing="0" style='width:864.00pt;border-collapse:collapse;table-layout:fixed;'>
   <col width="90" span="16" style='width:54.00pt;'/>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="26" width="990" colspan="11" style='height:15.60pt;width:594.00pt;border-right:none;border-bottom:none;' x:str>提供的服务（供接口）</td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>SADataService.find</td>
    <td x:str>语法</td>
    <td class="xl66" colspan="6" style='mso-ignore:colspan;' x:str>public SAPO find(long id)throws<span style='mso-spacerun:yes;'>&nbsp; </span>RemoteException</td>
    <td class="xl66"></td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>按ID进行查找返回相应的SAPO结果</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>SADataService.insert</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void insert(SAPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>同样ID的po在mapper中不存在</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中增加一个po记录</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>SADataService.delete</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void delete(SAPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>删除一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>SADataService.update</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void update(SAPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>更新一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>SADataService.init</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void init() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>初始化持久化数据库</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>SADataService.finish</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void finish() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>结束持久化数据库的使用</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <![if supportMisalignedColumns]>
    <tr width="0" style='display:none;'/>
   <![endif]>
  </table>

  <table width="1440" border="0" cellpadding="0" cellspacing="0" style='width:864.00pt;border-collapse:collapse;table-layout:fixed;'>
   <col width="90" span="16" style='width:54.00pt;'/>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="26" width="990" colspan="11" style='height:15.60pt;width:594.00pt;border-right:none;border-bottom:none;' x:str>提供的服务（供接口）</td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
    <td width="90" style='width:54.00pt;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>VIPDataService.find</td>
    <td x:str>语法</td>
    <td class="xl66" colspan="6" style='mso-ignore:colspan;' x:str>public VIPPO find(long id)throws<span style='mso-spacerun:yes;'>&nbsp; </span>RemoteException</td>
    <td class="xl66"></td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>按ID进行查找返回相应的VIPPO结果</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>VIPDataService.insert</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void insert(VIPPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>同样ID的po在mapper中不存在</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中增加一个po记录</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>VIPDataService.delete</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void delete(VIPPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>删除一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>VIPDataService.update</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void update(VIPPO po) throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>在数据库中存在相同ID的po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>更新一个po</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>VIPDataService.init</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void init() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>初始化持久化数据库</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td class="xl65" height="78.00" colspan="3" rowspan="3" style='height:46.80pt;border-right:none;border-bottom:none;' x:str>VIPDataService.finish</td>
    <td x:str>语法</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>public void finish() throws RemoteException</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>前置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>无</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <tr height="26" style='height:15.60pt;'>
    <td x:str>后置条件</td>
    <td class="xl65" colspan="7" style='border-right:none;border-bottom:none;' x:str>结束持久化数据库的使用</td>
    <td colspan="5" style='mso-ignore:colspan;'></td>
   </tr>
   <![if supportMisalignedColumns]>
    <tr width="0" style='display:none;'/>
   <![endif]>
  </table> 
  AdminDataService与MovieDataServicce同上，略去

## **6.信息视角**

系统的PO类就是相对应的相关的实体类，在此只做简单的介绍。

- UserPO类包含用户的用户名、密码属性。
- MoviePO类包含电影的名字、导演、演员、上映时间和想看人数。
- AdminPO类包含管理员的用户名、密码属性。

数据库表

- 数据库中包含User表，Movie表，Activity表，Activtiy_Movie表，bank_card表，coupon表等
# 连锁院线管理系统软件详细设计描述文档

| 修改人员                       | 日期      | 修改原因                                     | 版本号 |
| :----------------------------- | :-------- | :------------------------------------------- | :----- |
| 李天宇，杨承峰，陈熠涛，黄恺晟 | 2019.4.26 | 草拟文档结构                                 | V1.0   |
| 陈熠涛                         | 2019.6.16 | 添加user模块、statistics模块、management模块 | V1.1   |
| 李天宇                         | 2019.6.19 | 添加promotion模块                            | V1.2   |
| 杨承峰                         | 2019.6.20 | 添加records模块                              | V1.3   |
| 陈熠涛、李天宇、杨承峰         | 2019.6.20 | 汇总                                         | V1.4   |

# 1.引言

## 1.1编制目的

本报告详细完成对连续院线管理系统的详细设计，达到指导后续软件构造的目的，同时实现和测试人员以及用户的沟通。

本报告面向开发人员，测试人员以及最终用户而编写，是了解系统的导航。

## 1.2词汇表

| 词汇名称 | 词汇含义 | 备注 |
| :------- | :------- | :--- |
| NJU      | 南京大学 | ……   |
| ……       | ……       | ……   |

### 1.3 参考资料

1.IEEE std 1471-2000

2.丁二玉，刘钦.计算与软件工程（卷二）[M]机械工业出版社，2012：134—182

# 2. 产品描述

参考连锁院线管理系统用例文档和连锁院线管理系统需求规格说明文档中队产品的概括描述。

# 3.系统结构设计概述

参考连锁院线管理系统系统概要设计文档对体系结构设计的概述

# 4.结构视角

## 4.1业务逻辑层的开发包图参见软件体系结构文档图

### 4.1.1 user模块

#### （1）模块概述

user模块承担的需求参见需求规格说明文档功能需求及相关功能能需求

user模块的职责及接口参见软件系统结构描述文档相关部分

#### （2）整体结构

user模块为后端负责处理用户账户业务的模块。

该模块向前端提供bl.user.AcountService接口,以实现展示层和逻辑层分离。

AccountController用于逻辑控制，实现业务逻辑和控制逻辑的分离。

data.user.AccountMapper接口用于隔离数据层与逻辑层。

po.User作为用户账户业务的持久化对象添加到设计模型中；vo.UserForm, vo.UserVO 用于逻辑层和展示层间传值，vo.ResponseVO用于封装逻辑层和展示层之间传递的信息

user模块设计如下图所示![bl.user](https://i.loli.net/2019/06/19/5d0a58782e8e252972.jpg)



user模块各个类的的职责如下表所示

| 类                 | 职责                               |
| ------------------ | ---------------------------------- |
| AccountController  | 负责用户账户业务的逻辑控制         |
| AccountServiceImpl | 负责用户账户业务的详细业务逻辑实现 |

#### （3）模块内部类接口规范

AccountController依赖AccountServiceImpl提供的接口；AccountServiceImpl依赖AccountMapper提供的接口

##### AccountController的接口

| AccountController.login | 语法     | public ResponseVO login( UserForm userForm, HttpSession session) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 | 已创建一个AccountServiceImpl领域对象                         |
|                         | 后置条件 | 通过接口调用AccountServiceImpl中的login方法                  |



| AccountController.registerAccount | 语法     | public ResponseVO registerAccount( UserForm userForm) |
| --------------------------------- | -------- | ----------------------------------------------------- |
|                                   | 前置条件 | 已创建一个AccountServiceImpl领域对象                  |
|                                   | 后置条件 | 通过接口调用AccountServiceImpl中的registerAccount方法 |



| AccountController.logOut | 语法     | public ResponseVO logOut( HttpSession session) |
| ------------------------ | -------- | ---------------------------------------------- |
|                          | 前置条件 |                                                |
|                          | 后置条件 | 清除session中信息                              |



| AccountController.addStaff | 语法     | public ResponseVO addStaff( UserForm userForm) |
| -------------------------- | -------- | ---------------------------------------------- |
|                            | 前置条件 | 已创建一个AccountServiceImpl领域对象           |
|                            | 后置条件 | 通过接口调用AccountServiceImpl中的addStaff方法 |



| AccountController.searchAllStaff | 语法     | public ResponseVO searchAllStaff( )                  |
| -------------------------------- | -------- | ---------------------------------------------------- |
|                                  | 前置条件 | 已创建一个AccountServiceImpl领域对象                 |
|                                  | 后置条件 | 通过接口调用AccountServiceImpl中的searchAllStaff方法 |



| AccountController.updateStaff | 语法     | public ResponseVO updateStaff(UserForm updateStaffForm) |
| ----------------------------- | -------- | ------------------------------------------------------- |
|                               | 前置条件 | 已创建一个AccountServiceImpl领域对象                    |
|                               | 后置条件 | 通过接口调用AccountServiceImpl中的updateStaffInfo方法   |



| AccountController.delStaff | 语法     | public ResponseVO delStaff(int staffId)            |
| -------------------------- | -------- | -------------------------------------------------- |
|                            | 前置条件 | 已创建一个AccountServiceImpl领域对象               |
|                            | 后置条件 | 通过接口调用AccountServiceImpl中的delStaffById方法 |



| AccountController.getStaffInfo | 语法     | public ResponseVO getStaffInfo(int staffId)           |
| ------------------------------ | -------- | ----------------------------------------------------- |
|                                | 前置条件 | 已创建一个AccountServiceImpl领域对象                  |
|                                | 后置条件 | 通过接口调用AccountServiceImpl中的searchStaffById方法 |

##### AccountServiceImpl的接口



| AccountServiceImpl.login | 语法     | public ResponseVO login( UserForm userForm, HttpSession session) |
| ------------------------ | -------- | ------------------------------------------------------------ |
|                          | 前置条件 |                                                              |
|                          | 后置条件 | 更新session                                                  |



| AccountServiceImpl.registerAccount | 语法     | public ResponseVO registerAccount( UserForm userForm) |
| ---------------------------------- | -------- | ----------------------------------------------------- |
|                                    | 前置条件 |                                                       |
|                                    | 后置条件 | 更新用户信息                                          |



| AccountServiceImpl.logOut | 语法     | public ResponseVO logOut( HttpSession session) |
| ------------------------- | -------- | ---------------------------------------------- |
|                           | 前置条件 |                                                |
|                           | 后置条件 | 清除session中信息                              |



| AccountServiceImpl.addStaff | 语法     | public ResponseVO addStaff( UserForm userForm) |
| --------------------------- | -------- | ---------------------------------------------- |
|                             | 前置条件 |                                                |
|                             | 后置条件 | 更新用户信息                                   |



| AccountServiceImpl.searchAllStaff | 语法     | public ResponseVO searchAllStaff( ) |
| --------------------------------- | -------- | ----------------------------------- |
|                                   | 前置条件 |                                     |
|                                   | 后置条件 |                                     |



| AccountServiceImpl.updateStaff | 语法     | public ResponseVO updateStaff(UserForm updateStaffForm) |
| ------------------------------ | -------- | ------------------------------------------------------- |
|                                | 前置条件 |                                                         |
|                                | 后置条件 | 更新用户信息                                            |



| AccountServiceImpl.delStaffById | 语法     | public ResponseVO delStaffById(int staffId) |
| ------------------------------- | -------- | ------------------------------------------- |
|                                 | 前置条件 |                                             |
|                                 | 后置条件 | 更新用户信息                                |



| AccountServiceImpl.getStaffInfoById | 语法     | public ResponseVO getStaffInfoById(int staffId) |
| ----------------------------------- | -------- | ----------------------------------------------- |
|                                     | 前置条件 |                                                 |
|                                     | 后置条件 |                                                 |

### 4.1.2  statistics模块

#### （1）模块概述

statistics模块承担的需求参见需求规格说明文档功能需求及相关功能能需求

statistics模块的职责及接口参见软件系统结构描述文档相关部分

#### （2）整体结构

statistics模块为后端负责处理电影信息及用户想看电影统计信息的模块。

该模块向前端提供bl.statistics.MovieLikeService和bl.statistics.StatisticsService接口,以实现展示层和逻辑层分离。

StatisticsController用于逻辑控制，实现业务逻辑和控制逻辑的分离。

data.statistics.StatisticsMapper和data.statistics.MovieLikeMapper接口用于隔离数据层与逻辑层。

vo.ResponseVO用于封装逻辑层和展示层之间传递的信息

该模块涉及vo、po较多，此处省略

statistics模块设计如下图所示![bl.statistics](https://i.loli.net/2019/06/19/5d0a5878840c278366.png)user模块各个类的的职责如下表所示

| 类                    | 职责                                   |
| --------------------- | -------------------------------------- |
| StatisticsController  | 负责数据信息业务的逻辑控制             |
| StatisticsServiceImpl | 负责电影统计数据业务的详细业务逻辑实现 |
| MovieLikeServiceImpl  | 负责想看电影业务的详细业务逻辑实现     |

#### （3）模块内部类接口规范

StatisticsController依赖StatisticsServiceImpl、MovieLikeServiceImpl的接口；StatisticsServiceImpl、MovieLikeServiceImpl各自依赖StatisticsMapper和Movie

##### StatisticsController的接口

| StatisticsController.getScheduleRateByDate | 语法     | public ResponseVO getScheduleRateByDate(Date date) |
| ------------------------------------------ | -------- | -------------------------------------------------- |
|                                            | 前置条件 | 已创建一个statisticService领域对象                 |
|                                            | 后置条件 | 调用statiticsService中getScheduleRateByDate方法    |

| StatisticsController.getTotalBoxOffice | 语法     | public ResponseVO getTotalBoxOffice()       |
| -------------------------------------- | -------- | ------------------------------------------- |
|                                        | 前置条件 | 已创建一个statisticService领域对象          |
|                                        | 后置条件 | 调用statiticsService中getTotalBoxOffice方法 |

| StatisticsController.getAudiencePrice | 语法     | public ResponseVO getAudiencePrice(Date date) |
| ------------------------------------- | -------- | --------------------------------------------- |
|                                       | 前置条件 | 已创建一个statisticService领域对象            |
|                                       | 后置条件 | 调用statiticsService中getAudiencePrice方法    |

| StatisticsController.getMoviePlacingRateByDate | 语法     | public ResponseVO getMoviePlacingRateByDate(Date date) |
| ---------------------------------------------- | -------- | ------------------------------------------------------ |
|                                                | 前置条件 | 已创建一个statisticService领域对象                     |
|                                                | 后置条件 | 调用statiticsService中getMoviePlacingRateByDate方法    |

| StatisticsController.getPopularMovies | 语法     | public ResponseVO getPopularMovies(int days, int movieNum) |
| ------------------------------------- | -------- | ---------------------------------------------------------- |
|                                       | 前置条件 | 已创建一个statisticService领域对象                         |
|                                       | 后置条件 | 调用statiticsService中getPopularMovies方法                 |

##### StatisticsServiceImpl的接口

| StatisticsService.getScheduleRateByDate | 语法     | public ResponseVO getScheduleRateByDate(Date date) |
| --------------------------------------- | -------- | -------------------------------------------------- |
|                                         | 前置条件 |                                                    |
|                                         | 后置条件 |                                                    |

| StatisticsService.getTotalBoxOffice | 语法     | public ResponseVO getTotalBoxOffice() |
| ----------------------------------- | -------- | ------------------------------------- |
|                                     | 前置条件 |                                       |
|                                     | 后置条件 |                                       |

| StatisticsService.getAudiencePriceSevenDays | 语法     | public ResponseVO getAudiencePriceSevenDays(Date date) |
| ------------------------------------------- | -------- | ------------------------------------------------------ |
|                                             | 前置条件 |                                                        |
|                                             | 后置条件 |                                                        |

| StatisticsService.getMoviePlacingRateByDate | 语法     | public ResponseVO getMoviePlacingRateByDate(Date date) |
| ------------------------------------------- | -------- | ------------------------------------------------------ |
|                                             | 前置条件 |                                                        |
|                                             | 后置条件 |                                                        |

| StatisticsService.getPopularMovies | 语法     | public ResponseVO getPopularMovies(int days, int movieNum) |
| ---------------------------------- | -------- | ---------------------------------------------------------- |
|                                    | 前置条件 |                                                            |
|                                    | 后置条件 |                                                            |

##### MovieLikeServiceImpl的接口

| MovieLikeService.likeMovie | 语法     | public ResponseVO likeMovie(int userId, int movieId) |
| -------------------------- | -------- | ---------------------------------------------------- |
|                            | 前置条件 |                                                      |
|                            | 后置条件 | 更新想看电影数据                                     |

| MovieLikeService.unLikeMovie | 语法     | public ResponseVO unLikeMovie(int userId, int movieId) |
| ---------------------------- | -------- | ------------------------------------------------------ |
|                              | 前置条件 |                                                        |
|                              | 后置条件 | 更新想看电影数据                                       |

| MovieLikeService.getCountOfLikes | 语法     | public ResponseVO getCountOfLikes（int movieId) |
| -------------------------------- | -------- | ----------------------------------------------- |
|                                  | 前置条件 |                                                 |
|                                  | 后置条件 |                                                 |

| MovieLikeService.getLikeNumsGroupByDate | 语法     | public ResponseVO getLikeNumsGroupByDate(int movieId) |
| --------------------------------------- | -------- | ----------------------------------------------------- |
|                                         | 前置条件 |                                                       |
|                                         | 后置条件 |                                                       |

### 4.1.3 sales模块

#### (1) 模块概述

sales模块承担的需求参见需求规格说明文档功能需求及相关功能能需求

sales模块的职责及接口参见软件系统结构描述文档相关部分

#### (2) 整体结构

sales模块为后端负责处理电影票购买业务的模块。

该模块向前端提供bl.sales.TicketService接口,以实现展示层和逻辑层分离。

TicketController用于逻辑控制，实现业务逻辑和控制逻辑的分离。

data.sales.TicketMapper接口用于隔离数据层与逻辑层。

vo.ResponseVO用于封装逻辑层和展示层之间传递的信息

该模块涉及vo、po较多，此处省略

sales模块设计如下图所示

![bl.sales](https://i.loli.net/2019/06/19/5d0a5877baa9c63677.png)

| 类                | 职责                   |
| ----------------- | ---------------------- |
| TicektController  | 负责票务的逻辑控制     |
| TicketServiceImpl | 负责票务的业务逻辑实现 |

#### (3) 模块内部类接口规范

ticketController依赖ticketServiceImpl的接口，ticketServiceImpl依赖MovieService、ActivityService、CouponService、VIPService、RecordsService、TicketService、HallServiceForBl、ScheduleServiceForBl和TicketMapper以及ComsumptionRecordMapper

##### ticketController的接口

| ticketController.buyTicketByVIPCard | 语法     | public ResponseVO buyTicketByVIPCard(List\<Integer\> ticketId, int couponId) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 | 已创建一个ticketService领域对象                              |
|                                     | 后置条件 | 调用ticketService中的completeTicketByVIPCard方法             |

| ticketController.lockSeat | 语法     | public ResponseVO lockSeat(TicketForm ticketForm) |
| ------------------------- | -------- | ------------------------------------------------- |
|                           | 前置条件 | 已创建一个ticketService领域对象                   |
|                           | 后置条件 | 调用ticketService中的addSeatt方法                 |

| ticketController.buyTicket | 语法     | public ResponseVO buyTicket(List\<Integer\> ticketId, int couponId) |
| -------------------------- | -------- | ------------------------------------------------------------ |
|                            | 前置条件 | 已创建一个ticketService领域对象                              |
|                            | 后置条件 | 调用ticketService中的completeTicket方法                      |

| ticketController.getTicketByUserId | 语法     | public ResponseVO getTicketByUserId(int userId) |
| ---------------------------------- | -------- | ----------------------------------------------- |
|                                    | 前置条件 | 已创建一个ticketService领域对象                 |
|                                    | 后置条件 | 调用ticketService中getTicketByUserId的方法      |

| ticketController.getTicketByOrderID | 语法     | public ResponseVO getTicketByOrderID(int orderID) |
| ----------------------------------- | -------- | ------------------------------------------------- |
|                                     | 前置条件 | 已创建一个ticketService领域对象                   |
|                                     | 后置条件 | 调用ticketService中getTicketByOrderID的方法       |

| ticketController.getOccupiedSeats | 语法     | public ResponseVO getOccupiedSeats(int scheduleId) |
| --------------------------------- | -------- | -------------------------------------------------- |
|                                   | 前置条件 | 已创建一个ticketService领域对象                    |
|                                   | 后置条件 | 调用ticketService中getBySchedule的方法             |

| ticketController.refundTicket | 语法     | public ResponseVO refundTicket(List<Integer> ticketId) |
| ----------------------------- | -------- | ------------------------------------------------------ |
|                               | 前置条件 | 已创建一个ticketService领域对象                        |
|                               | 后置条件 | 调用ticketService中refundTickets方法                   |

| ticketController.addRefundStrategy | 语法     | public ResponseVO addRefundStrategy(RefundStrategyForm refundStrategyForm) |
| ---------------------------------- | -------- | ------------------------------------------------------------ |
|                                    | 前置条件 | 已创建一个ticketService领域对象                              |
|                                    | 后置条件 | 调用ticketService中addRefundStrategy方法                     |

| ticketController.updateRefundStrategy | 语法     | public ResponseVO updateRefundStrategy(RefundStrategyForm refundStrategyForm) |
| ------------------------------------- | -------- | ------------------------------------------------------------ |
|                                       | 前置条件 | 已创建一个ticketService领域对象                              |
|                                       | 后置条件 | 调用ticketService中updateRefundStrategy方法                  |

| ticketController.showAllRefundStrategy | 语法     | public ResponseVO showAllRefundStrategy()      |
| -------------------------------------- | -------- | ---------------------------------------------- |
|                                        | 前置条件 | 已创建一个ticketService领域对象                |
|                                        | 后置条件 | 调用ticketService中selectAllRefundStrategy方法 |

| ticketController.useRefundStrategy | 语法     | public ResponseVO useRefundStrategy(int id) |
| ---------------------------------- | -------- | ------------------------------------------- |
|                                    | 前置条件 | 已创建一个ticketService领域对象             |
|                                    | 后置条件 | 调用ticketService中useRefundStrategy方法    |

##### ticketServiceImpl的接口

| ticketServiceImpl.buyTicketByVIPCard | 语法     | public ResponseVO buyTicketByVIPCard(List\<Integer\> ticketId, int couponId) |
| ------------------------------------ | -------- | ------------------------------------------------------------ |
|                                      | 前置条件 |                                                              |
|                                      | 后置条件 | 更新相关订单和票数据                                         |

| ticketServiceImpl.lockSeat | 语法     | public ResponseVO lockSeat(TicketForm ticketForm) |
| -------------------------- | -------- | ------------------------------------------------- |
|                            | 前置条件 |                                                   |
|                            | 后置条件 | 更新相关订单和票数据                              |

| ticketServiceImpl.buyTicket | 语法     | public ResponseVO buyTicket(List\<Integer\> ticketId, int couponId) |
| --------------------------- | -------- | ------------------------------------------------------------ |
|                             | 前置条件 |                                                              |
|                             | 后置条件 | 更新相关订单和票数据                                         |

| ticketServiceImpl.getTicketByUserId | 语法     | public ResponseVO getTicketByUserId(int userId) |
| ----------------------------------- | -------- | ----------------------------------------------- |
|                                     | 前置条件 |                                                 |
|                                     | 后置条件 |                                                 |

| ticketServiceImpl.getTicketByOrderID | 语法     | public ResponseVO getTicketByOrderID(int orderID) |
| ------------------------------------ | -------- | ------------------------------------------------- |
|                                      | 前置条件 |                                                   |
|                                      | 后置条件 |                                                   |

| ticketServiceImpl.getOccupiedSeats | 语法     | public ResponseVO getOccupiedSeats(int scheduleId) |
| ---------------------------------- | -------- | -------------------------------------------------- |
|                                    | 前置条件 |                                                    |
|                                    | 后置条件 |                                                    |

| ticketServiceImpl.refundTicket | 语法     | public ResponseVO refundTicket(List<Integer> ticketId) |
| ------------------------------ | -------- | ------------------------------------------------------ |
|                                | 前置条件 |                                                        |
|                                | 后置条件 | 更新相关订单和票数据                                   |

| ticketServiceImpl.addRefundStrategy | 语法     | public ResponseVO addRefundStrategy(RefundStrategyForm refundStrategyForm) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 | 更新退款政策数据                                             |

| ticketServiceImpl.updateRefundStrategy | 语法     | public ResponseVO updateRefundStrategy(RefundStrategyForm refundStrategyForm) |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
|                                        | 前置条件 |                                                              |
|                                        | 后置条件 | 更新退款政策数据                                             |

| ticketServiceImpl.showAllRefundStrategy | 语法     | public ResponseVO showAllRefundStrategy() |
| --------------------------------------- | -------- | ----------------------------------------- |
|                                         | 前置条件 |                                           |
|                                         | 后置条件 |                                           |

| ticketServiceImpl.useRefundStrategy | 语法     | public ResponseVO useRefundStrategy(int id) |
| ----------------------------------- | -------- | ------------------------------------------- |
|                                     | 前置条件 |                                             |
|                                     | 后置条件 | 更新退款政策数据                            |

### 4.1.4 management模块

#### (1) 模块概述

management模块承担的需求参见需求规格说明文档功能需求及相关功能能需求

management模块的职责及接口参见软件系统结构描述文档相关部分

#### (2) 整体结构

management模块为后端负责影院信息管理业务的模块。

该模块向前端提供hallService, movieService, scheduleService接口,以实现展示层和逻辑层分离。

HallController,movieController,scheduleController用于逻辑控制，实现业务逻辑和控制逻辑的分离。

data.management.hallMapper,data.management.movieMapper,data.management.scheduleMapper,接口用于隔离数据层与逻辑层。

vo.ResponseVO用于封装逻辑层和展示层之间传递的信息

该模块涉及vo、po较多，此处省略

management模块设计如下图所示

![bl.management](https://i.loli.net/2019/06/19/5d0a587910f7773519.png)

#### (3) 模块内部类接口规范

controller都依赖相应实现提供的接口，实现依赖相应mapper和包内其他service集成出来的接口

##### hallController的接口

| hallController.searchAllHall | 语法     | public ResponseVO searchAllHall()  |
| ---------------------------- | -------- | ---------------------------------- |
|                              | 前置条件 | 已创建一个hallService领域对象      |
|                              | 后置条件 | 调用hallService中searchAllHall方法 |

| hallController.addHall | 语法     | public ResponseVO addHall(HallInfoFrom hallInfoForm) |
| ---------------------- | -------- | ---------------------------------------------------- |
|                        | 前置条件 | 已创建一个hallService领域对象                        |
|                        | 后置条件 | 调用hallService中addHall方法                         |

| hallController.changeHallInfo | 语法     | public ResponseVO changeHallInfo(HallVO hallVO) |
| ----------------------------- | -------- | ----------------------------------------------- |
|                               | 前置条件 | 已创建一个hallService领域对象                   |
|                               | 后置条件 | 调用hallService中changeHallInfo方法             |

| hallController.deleteHallInfo | 语法     | public ResponseVO deleteHallInfo(int id) |
| ----------------------------- | -------- | ---------------------------------------- |
|                               | 前置条件 | 已创建一个hallService领域对象            |
|                               | 后置条件 | 调用hallService中deleteHallInfo方法      |

##### hallServiceImpl的接口

| hallServiceImpl.searchAllHall | 语法     | public ResponseVO searchAllHall() |
| ----------------------------- | -------- | --------------------------------- |
|                               | 前置条件 |                                   |
|                               | 后置条件 |                                   |

| hallServiceImpl.addHall | 语法     | public ResponseVO addHall(HallInfoFrom hallInfoForm) |
| ----------------------- | -------- | ---------------------------------------------------- |
|                         | 前置条件 |                                                      |
|                         | 后置条件 | 更新影厅数据                                         |

| hallServiceImpl.changeHallInfo | 语法     | public ResponseVO changeHallInfo(HallVO hallVO) |
| ------------------------------ | -------- | ----------------------------------------------- |
|                                | 前置条件 |                                                 |
|                                | 后置条件 | 更新影厅数据                                    |

| hallServiceImpl.deleteHallInfo | 语法     | public ResponseVO deleteHallInfo(int id) |
| ------------------------------ | -------- | ---------------------------------------- |
|                                | 前置条件 |                                          |
|                                | 后置条件 | 更新影厅数据                             |

| hallServiceImpl.getHallById | 语法     | public ResponseVO getHallById(int id) |
| --------------------------- | -------- | ------------------------------------- |
|                             | 前置条件 |                                       |
|                             | 后置条件 |                                       |

其中getHallById用于实现了HallServiceForBl的接口

##### movieController的接口

| movieController.addMovie | 语法     | public ResponseVO addMovie(MovieForm addMovieForm) |
| ------------------------ | -------- | -------------------------------------------------- |
|                          | 前置条件 | 已创建一个movieService领域对象                     |
|                          | 后置条件 | 调用movieService中的addMovie方法                   |

| movieController.searchOneMovieByIdAndUserId | 语法     | public ResponseVO searchOneMovieByIdAndUserId(int id, int userId) |
| ------------------------------------------- | -------- | ------------------------------------------------------------ |
|                                             | 前置条件 | 已创建一个movieService领域对象                               |
|                                             | 后置条件 | 调用movieService中的addMovie方法                             |

| movieController.searchAllMovie | 语法     | public ResponseVO searchAllMovie()     |
| ------------------------------ | -------- | -------------------------------------- |
|                                | 前置条件 | 已创建一个movieService领域对象         |
|                                | 后置条件 | 调用movieService中的searchAllMovie方法 |

| movieController.searchOtherMoviesExcludeOff | 语法     | public ResponseVO searchOtherMoviesExcludeOff()     |
| ------------------------------------------- | -------- | --------------------------------------------------- |
|                                             | 前置条件 | 已创建一个movieService领域对象                      |
|                                             | 后置条件 | 调用movieService中的searchOtherMoviesExcludeOff方法 |

| movieController.likeMovie | 语法     | public ResponseVO likeMovie(int userId, int movieId) |
| ------------------------- | -------- | ---------------------------------------------------- |
|                           | 前置条件 | 已创建一个movieService领域对象                       |
|                           | 后置条件 | 调用movieService中的likeMovie方法                    |

| movieController.unLikeMovie | 语法     | public ResponseVO unLikeMovie(int userId, int movieId) |
| --------------------------- | -------- | ------------------------------------------------------ |
|                             | 前置条件 | 已创建一个movieService领域对象                         |
|                             | 后置条件 | 调用movieService中的unLikeMovie方法                    |

| movieController.getMovieLikeCounts | 语法     | public ResponseVO getMovieLikeCounts(int movieId) |
| ---------------------------------- | -------- | ------------------------------------------------- |
|                                    | 前置条件 | 已创建一个movieService领域对象                    |
|                                    | 后置条件 | 调用movieService中的getMovieLikeCounts(方法       |

| movieController.getMovieLikeCountByDate | 语法     | public ResponseVO getMovieLikeCountByDate(int movieId) |
| --------------------------------------- | -------- | ------------------------------------------------------ |
|                                         | 前置条件 | 已创建一个movieService领域对象                         |
|                                         | 后置条件 | 调用movieService中的getMovieLikeCountByDate方法        |

| movieController.getMovieByKeyword | 语法     | public ResponseVO getMovieByKeyword(String keyword) |
| --------------------------------- | -------- | --------------------------------------------------- |
|                                   | 前置条件 | 已创建一个movieService领域对象                      |
|                                   | 后置条件 | 调用movieService中的getMovieByKeyword方法           |

| movieController.pullOfBatchOfMovie | 语法     | public ResponseVO pullOfBatchOfMovie(MovieBatchOffForm movieBatchOffForm) |
| ---------------------------------- | -------- | ------------------------------------------------------------ |
|                                    | 前置条件 | 已创建一个movieService领域对象                               |
|                                    | 后置条件 | 调用movieService中的pullOfBatchOfMovie方法                   |

| movieController.updateMovie | 语法     | public ResponseVO updateMovie(MovieForm movieUpdateForm) |
| --------------------------- | -------- | -------------------------------------------------------- |
|                             | 前置条件 | 已创建一个movieService领域对象                           |
|                             | 后置条件 | 调用movieService中的updateMovie方法                      |

##### movieServiceImpl的接口

| movieServiceImpl.addMovie | 语法     | public ResponseVO addMovie(MovieForm addMovieForm) |
| ------------------------- | -------- | -------------------------------------------------- |
|                           | 前置条件 |                                                    |
|                           | 后置条件 | 更新电影数据                                       |

| movieServiceImpl.searchOneMovieByIdAndUserId | 语法     | public ResponseVO searchOneMovieByIdAndUserId(int id, int userId) |
| -------------------------------------------- | -------- | ------------------------------------------------------------ |
|                                              | 前置条件 |                                                              |
|                                              | 后置条件 |                                                              |

| movieServiceImpl.searchAllMovie | 语法public ResponseVO searchAllMovie() |      |
| ------------------------------- | -------------------------------------- | ---- |
|                                 | 前置条件                               |      |
|                                 | 后置条件                               |      |

| movieServiceImpl.searchOtherMoviesExcludeOff | 语法     | public ResponseVO searchOtherMoviesExcludeOff() |
| -------------------------------------------- | -------- | ----------------------------------------------- |
|                                              | 前置条件 |                                                 |
|                                              | 后置条件 |                                                 |

| movieServiceImpl.getMovieByKeyword | 语法     | public ResponseVO getMovieByKeyword(String keyword) |
| ---------------------------------- | -------- | --------------------------------------------------- |
|                                    | 前置条件 |                                                     |
|                                    | 后置条件 |                                                     |

| movieServiceImpl.pullOfBatchOfMovie | 语法     | public ResponseVO pullOfBatchOfMovie(MovieBatchOffForm movieBatchOffForm) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 | 更新电影数据                                                 |

| movieServiceImpl.updateMovie | 语法     | public ResponseVO updateMovie(MovieForm movieUpdateForm) |
| ---------------------------- | -------- | -------------------------------------------------------- |
|                              | 前置条件 |                                                          |
|                              | 后置条件 | 更新电影数据                                             |

| movieServiceImpl.getMovieById | 语法     | public ResponseVO getMovieById(int movieId) |
| ----------------------------- | -------- | ------------------------------------------- |
|                               | 前置条件 |                                             |
|                               | 后置条件 |                                             |

其中给MovieById实现了MovieServiceForBl的接口

##### scheduleController的接口

| scheduleController.addSchedule | 语法     | public ResponseVO addSchedule(SchdeuleForm scheduleForm) |
| ------------------------------ | -------- | -------------------------------------------------------- |
|                                | 前置条件 | 已创建一个scheduleService领域对象                        |
|                                | 后置条件 | 调用scheduleService中addSchedule方法                     |

| scheduleController.updateSchedule | 语法     | public ResponseVO updateSchedule(SchdeuleForm scheduleForm) |
| --------------------------------- | -------- | ----------------------------------------------------------- |
|                                   | 前置条件 | 已创建一个scheduleService领域对象                           |
|                                   | 后置条件 | 调用scheduleService中updateSchedule方法                     |

| scheduleController.searchSchedule | 语法     | public ResponseVO searchSchedule(int hallId, Date startDate) |
| --------------------------------- | -------- | ------------------------------------------------------------ |
|                                   | 前置条件 | 已创建一个scheduleService领域对象                            |
|                                   | 后置条件 | 调用scheduleService中searchSchedule方法                      |

| scheduleController.searchAudienceSchedule | 语法     | public ResponseVO searchAudienceSchedule(int movieId) |
| ----------------------------------------- | -------- | ----------------------------------------------------- |
|                                           | 前置条件 | 已创建一个scheduleService领域对象                     |
|                                           | 后置条件 | 调用scheduleService中searchAudienceSchedule方法       |

| scheduleController.setScheduleView | 语法     | public ResponseVO setScheduleViewScheduleViewForm scheduleViewForm) |
| ---------------------------------- | -------- | ------------------------------------------------------------ |
|                                    | 前置条件 | 已创建一个scheduleService领域对象                            |
|                                    | 后置条件 | 调用scheduleService中setScheduleViewScheduleViewForm方法     |

| scheduleController.getScheduleView | 语法     | public ResponseVO getScheduleView()      |
| ---------------------------------- | -------- | ---------------------------------------- |
|                                    | 前置条件 | 已创建一个scheduleService领域对象        |
|                                    | 后置条件 | 调用scheduleService中getScheduleView方法 |

| scheduleController.deleteBatchOfSchedule | 语法     | public ResponseVO deleteBatchOfSchedule(ScheduleBatchDeleteForm scheduleBatchDeleteForm) |
| ---------------------------------------- | -------- | ------------------------------------------------------------ |
|                                          | 前置条件 | 已创建一个scheduleService领域对象                            |
|                                          | 后置条件 | 调用scheduleService中deleteBatchOfSchedule方法               |

| scheduleController.getScheduleById | 语法     | public ResponseVO getScheduleById(int id) |
| ---------------------------------- | -------- | ----------------------------------------- |
|                                    | 前置条件 | 已创建一个scheduleService领域对象         |
|                                    | 后置条件 | 调用scheduleService中getScheduleById方法  |

##### scheduleServiceImpl的接口

| scheduleServiceImpl.addSchedule | 语法     | public ResponseVO addSchedule(SchdeuleForm scheduleForm) |
| ------------------------------- | -------- | -------------------------------------------------------- |
|                                 | 前置条件 |                                                          |
|                                 | 后置条件 | 更新排片数据                                             |

| scheduleServiceImpl.updateSchedule | 语法     | public ResponseVO updateSchedule(SchdeuleForm scheduleForm) |
| ---------------------------------- | -------- | ----------------------------------------------------------- |
|                                    | 前置条件 |                                                             |
|                                    | 后置条件 | 更新排片数据                                                |

| scheduleServiceImpl.searchScheduleSevenDays | 语法     | public ResponseVO searchScheduleSevenDays(int hallId, Date startDate) |
| ------------------------------------------- | -------- | ------------------------------------------------------------ |
|                                             | 前置条件 |                                                              |
|                                             | 后置条件 |                                                              |

| scheduleServiceImpl.searchAudienceSchedule | 语法     | public ResponseVO searchAudienceSchedule(int movieId) |
| ------------------------------------------ | -------- | ----------------------------------------------------- |
|                                            | 前置条件 |                                                       |
|                                            | 后置条件 |                                                       |

| scheduleServiceImpl.setScheduleView | 语法     | public ResponseVO setScheduleView(ScheduleViewForm scheduleViewForm) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 | 更新排片设置数据                                             |

| scheduleServiceImpl.getScheduleView | 语法     | public ResponseVO getScheduleView() |
| ----------------------------------- | -------- | ----------------------------------- |
|                                     | 前置条件 |                                     |
|                                     | 后置条件 |                                     |

| scheduleServiceImpl.deleteBatchOfSchedule | 语法     | public ResponseVO deleteBatchOfSchedule(ScheduleBatchDeleteForm scheduleBatchDeleteForm) |
| ----------------------------------------- | -------- | ------------------------------------------------------------ |
|                                           | 前置条件 |                                                              |
|                                           | 后置条件 | 更新排片数据                                                 |

| scheduleServiceImpl.getScheduleById | 语法     | public ResponseVO getScheduleById(int id) |
| ----------------------------------- | -------- | ----------------------------------------- |
|                                     | 前置条件 |                                           |
|                                     | 后置条件 |                                           |

| scheduleServiceImpl.getScheduleItemById | 语法     | public ResponseVO getScheduleItemById(int id) |
| --------------------------------------- | -------- | --------------------------------------------- |
|                                         | 前置条件 |                                               |
|                                         | 后置条件 |                                               |

| scheduleServiceImpl.getScheduleByMovieIdList | 语法     | public ResponseVO getScheduleByMovieIdList(List movieList) |
| -------------------------------------------- | -------- | ---------------------------------------------------------- |
|                                              | 前置条件 |                                                            |
|                                              | 后置条件 |                                                            |

其中getScheduleByMovieIdList和getScheduleItemById实现scheduleServiceForBl的接口

### 4.1.5promotion模块

#### (1) 模块概述

promotion模块承担的需求参见需求规格说明文档功能需求及相关功能能需求

promotion模块的职责及接口参见软件系统结构描述文档相关部分

#### (2) 整体结构

promotiont模块为后端负责影院优惠活动相关业务的模块。

该模块向前端提供activityService, couponService, VIPcardService接口,以实现展示层和逻辑层分离。

ActivityController,CouponController,VIPcardController用于逻辑控制，实现业务逻辑和控制逻辑的分离。

data.promotion,activityMapper,data.promotiont.couponMapper,data.promotion.VIPcardMapper,接口用于隔离数据层与逻辑层。

vo.ResponseVO用于封装逻辑层和展示层之间传递的信息

该模块涉及vo、po较多，此处省略

promotion模块设计如下图所示

![bl.promotion](https://i.loli.net/2019/06/19/5d0a5824e5c3758556.jpg)

| 类                | 职责                   |
| ----------------- | ---------------------- |
| VIPcardController  | 负责vip卡的逻辑控制     |
| VIPcardServiceImpl | 负责vip卡的业务逻辑实现 |

#### (3) 模块内部类接口规范

VIPcardController依赖VIPcardServiceImpl的接口，VIPcardServiceImpl依赖AccountService、ActivityService、CouponService、RecordsService和VIPcardMpper接口

##### VIPcardController的接口

| VIPcardController.addVIP | 语法     | public ResponseVO addVIP(int userId, @RequestBody BankCardForm bankCardForm) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 |                                                              |

| VIPcardController.getVIP | 语法     | public ResponseVO getVIP(int userId) |
| ------------------------- | -------- | ------------------------------------------------- |
|                           | 前置条件 |                                                   |
|                           | 后置条件 |                                                   |

| VIPcardController.charge | 语法     | public ResponseVO  charge(VIPchargeVO viPchargeVO) |
| -------------------------- | -------- | ------------------------------------------------------------ |
|                            | 前置条件 |                                                              |
|                            | 后置条件 |                                                              |

| VIPcardController.addDiscountStrategy | 语法     | public ResponseVO addDiscountStrategy(VIPDiscountStrategyForm vipDiscountStrategyForm) |
| ---------------------------------- | -------- | ----------------------------------------------- |
|                                    | 前置条件 |                                                 |
|                                    | 后置条件 |                                                 |

| VIPcardController.getAllDiscountStrategy | 语法     | public ResponseVO getAllDiscountStrategy() |
| ----------------------------------- | -------- | ------------------------------------------------- |
|                                     | 前置条件 |                                                   |
|                                     | 后置条件 |                                                   |

| VIPcardController.deleteStrategy | 语法     | public ResponseVO updateDiscountStrategy(vipDiscountStrategy) |
| --------------------------------- | -------- | -------------------------------------------------- |
|                                   | 前置条件 |                                                    |
|                                   | 后置条件 |                                                    |

| VIPcardController.deleteStrategy | 语法     | public ResponseVO deleteStrategy(int StrategyID) |
| ----------------------------- | -------- | ------------------------------------------------------ |
|                               | 前置条件 |                                                        |
|                               | 后置条件 |                                                        |

| VIPcardController.getUserByAmount | 语法     | public ResponseVO getUserByAmount(int amount) |
| ---------------------------------- | -------- | ------------------------------------------------------------ |
|                                    | 前置条件 |                                                              |
|                                    | 后置条件 |                                                              |

| VIPcardController.setVIPCardPrice | 语法     | public ResponseVO setVIPCardPrice(double price) |
| ------------------------------------- | -------- | ------------------------------------------------------------ |
|                                       | 前置条件 |                                                              |
|                                       | 后置条件 |                                                              |

| VIPcardController.giveCoupon | 语法     | public ResponseVO giveCoupon(GiveCouponVO giveCouponVO) |
| -------------------------------------- | -------- | ----------------------------------------- |
|                                        | 前置条件 |                                           |
|                                        | 后置条件 |                                           |

| VIPcardController.useRefundStrategy | 语法     | public ResponseVO useRefundStrategy(int id) |
| ---------------------------------- | -------- | ------------------------------------------- |
|                                    | 前置条件 |                                             |
|                                    | 后置条件 |                                             |

##### VIPServiceImpl的接口

| VIPcardServiceImpl.addVIPCard() | 语法     | public ResponseVO addVIPCard(int userId,BankCardForm bankCardForm) |
| ------------------------------------ | -------- | ------------------------------------------------------------ |
|                                      | 前置条件 |                                                              |
|                                      | 后置条件 |                                                              |

| VIPcardServiceImpl.getCardById() | 语法     |  public ResponseVO getCardById(int id) |
| -------------------------- | -------- | ------------------------------------------------- |
|                            | 前置条件 |                                                   |
|                            | 后置条件 |                                                   |

| VIPcardServiceImpl.getVIPInfo() | 语法     | public ResponseVO getVIPInfo()  |
| --------------------------- | -------- | ------------------------------------------------------------ |
|                             | 前置条件 |                                                              |
|                             | 后置条件 |                                                              |

| VIPcardServiceImpl.charge() | 语法     | public ResponseVO charge(VIPchargeVO viPchargeVO) |
| ----------------------------------- | -------- | ----------------------------------------------- |
|                                     | 前置条件 |                                                 |
|                                     | 后置条件 |                                                 |

| VIPcardServiceImpl.refund() | 语法     | public ResponseVO refund(VIPCardForm vipCardForm) |
| ------------------------------------ | -------- | ------------------------------------------------- |
|                                      | 前置条件 |                                                   |
|                                      | 后置条件 |                                                   |

| VIPcardServiceImpl.getCardByUserId() | 语法     | public ResponseVO getCardByUserId(int userId)  |
| ---------------------------------- | -------- | -------------------------------------------------- |
|                                    | 前置条件 |                                                    |
|                                    | 后置条件 |                                                    |

| VIPcardServiceImpl.cardBuy() | 语法     |  public ResponseVO cardBuy(VIPCardForm vipCardForm) |
| ------------------------------ | -------- | ------------------------------------------------------ |
|                                | 前置条件 |                                                        |
|                                | 后置条件 |                                                        |

| VIPcardServiceImpl.addVIPDiscountStrategy() | 语法     |  public     ResponseVO addVIPDiscountStrategy(int quota,int gift) |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
|                                     | 前置条件 |                                                              |
|                                     | 后置条件 |                                                              |

| VIPcardServiceImpl.getDiscountStrategy() | 语法     |public ResponseVO getDiscountStrategy() |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
|                                        | 前置条件 |                                                              |
|                                        | 后置条件 |                                                              |


| VIPcardServiceImpl.deleteDiscountStrategy() | 语法     |  public ResponseVO deleteDiscountStrategy(int strategyID) |
| ----------------------------------- | -------- | ------------------------------------------- |
|                                     | 前置条件 |                                             |
|                                     | 后置条件 |                                             |

| VIPcardServiceImpl.getUserByAmount() | 语法     |   public ResponseVO getUserByAmount(int amount) |
| ----------------------------------- | -------- | ------------------------------------------- |
|                                     | 前置条件 |                                             |
|                                     | 后置条件 |                                             |

| VIPcardServiceImpl.giveCoupon() | 语法     |  public ResponseVO giveCoupon(GiveCouponVO giveCouponVO) |
| ----------------------------------- | -------- | ------------------------------------------- |
|                                     | 前置条件 |                                             |
|                                     | 后置条件 |                                             |

AccountController依赖AccountServiceImpl提供的接口；AccountServiceImpl依赖AccountMapper提供的接口

##### CouponController的接口

| CouponController.getCoupons | 语法     | public ResponseVO getCoupons(int userId)|
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |          |



##### CouponServiceImpl的接口


| CouponServiceImpl.getCouponsByUser| 语法     | public ResponseVO getCouponsByUser(int userId) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |          |



| CouponServiceImpl.addCoupon| 语法     | public ResponseVO addCoupon(CouponForm couponForm) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |



| CouponServiceImpl.issueCoupon | 语法     | public ResponseVO issueCoupon(int couponId,int userId); |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |




| CouponServiceImpl.usedCoupon| 语法     | public ResponseVO usedCoupon(int couponId,int userId); |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |


| CouponServiceImpl.getCouponById| 语法     | public Coupon getCouponById(int couponId); |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |

##### ActivityController的接口

| ActivityController.publishActivity| 语法     | public ResponseVO publishActivity(ActivityForm activityForm)|
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |          |


| ActivityController.publishActivity| 语法     | public ResponseVO getActivities()|
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |          |



##### ActivityServiceImpl的接口


| ActivityServiceImpl.publishActivity| 语法     | public ResponseVO publishActivity(ActivityForm activityForm) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |          |



| ActivityServiceImpl.getActivities()| 语法     | public ResponseVO getActivities(); |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |



| ActivityServiceImpl.getActivityById| 语法     | public ResponseVO getActivityById(int id) |
| ----------------------- | -------- | ------------------------------------------------------------ |
|                         | 前置条件 |               |
|                         | 后置条件 |




### 4.1.6 records模块

#### (1) 模块概述

records模块承担的需求参见需求规格说明文档功能需求及相关功能能需求

recors模块的职责及接口参见软件系统结构描述文档对应部分

#### (2) 整体结构

records模块为后端负责处理电影票充值、消费的模块。

该模块向前端提供bl.records.RecordsService接口,以实现展示层和逻辑层分离。

RecordsController用于逻辑控制，实现业务逻辑和控制逻辑的分离。

data.records.ChargeRecordMapper和ComsumptionRecordMapper接口用于隔离数据层与逻辑层。

vo.ResponseVO用于封装逻辑层和展示层之间传递的信息

该模块涉及vo、po较多，此处省略

sales模块设计如下图所示

![bl.sales](C:\Users\Administrator\Desktop\详细\RECORD.jpg)

| 类                 | 职责                             |
| ------------------ | -------------------------------- |
| RecordsController  | 负责充值、消费记录获取的逻辑控制 |
| RecordsServiceImpl | 负责充值、消费记录的业务逻辑实现 |

#### (3) 模块内部类接口规范

RecordsController依赖RecordsServiceImpl的接口，RecordsServiceImpl依赖chargeRecordMapper、vipCardMapper以及ComsumptionRecordMapper

##### RecordsController的接口

| RecordsController.getAllChargeRecords | 语法     | public ResponseVO getAllChargeRecords()                |
| ------------------------------------- | -------- | ------------------------------------------------------ |
|                                       | 前置条件 | 已创建一个RecordsServiceImpl领域对象                   |
|                                       | 后置条件 | 通过接口调用RecordsServiceImpl中的getChargeRecords方法 |

| RecordsController.getChargeRecordById | 语法     | public ResponseVO getChargeRecordById(@PathVariable int recordId) |
| ------------------------------------- | -------- | ------------------------------------------------------------ |
|                                       | 前置条件 | 已创建一个RecordsServiceImpl领域对象                         |
|                                       | 后置条件 | 通过接口调用RecordsServiceImpl中的getChargeRecordsById方法   |

| RecordsController.selectChargeRecordByUserID | 语法     | public ResponseVO selectChargeRecordByUserID(@PathVariable int userId) |
| -------------------------------------------- | -------- | ------------------------------------------------------------ |
|                                              | 前置条件 | 已创建一个RecordsServiceImpl领域对象                         |
|                                              | 后置条件 | 通过接口调用RecordsServiceImpl中的getChargeRecordsByUserID方法 |

| RecordsController.getComsumptionRecords | 语法     | public ResponseVO getComsumptionRecords()                    |
| --------------------------------------- | -------- | ------------------------------------------------------------ |
|                                         | 前置条件 | 已创建一个RecordsServiceImpl领域对象                         |
|                                         | 后置条件 | 通过接口调用RecordsServiceImpl中的getAllComsumptionRecords方法 |

| RecordsController.getComsumptionRecordsByOrderID | 语法     | public ResponseVO getComsumptionRecords()                    |
| ------------------------------------------------ | -------- | ------------------------------------------------------------ |
|                                                  | 前置条件 | 已创建一个RecordsServiceImpl领域对象                         |
|                                                  | 后置条件 | 通过接口调用RecordsServiceImpl中的getComRecordsByOrderID方法 |

| RecordsController.getComsumptionRecordsByUserID | 语法     | public ResponseVO getComsumptionRecordsByUserID(int userID) |
| ----------------------------------------------- | -------- | ----------------------------------------------------------- |
|                                                 | 前置条件 | 已创建一个RecordsServiceImpl领域对象                        |
|                                                 | 后置条件 | 通过接口调用RecordsServiceImpl中的getComRecordsByUserID方法 |

| RecordsController.getOrderRecord | 语法     | public ResponseVO getOrderRecord(int orderID)                |
| -------------------------------- | -------- | ------------------------------------------------------------ |
|                                  | 前置条件 | 已创建一个RecordsServiceImpl领域对象                         |
|                                  | 后置条件 | 通过接口调用RecordsServiceImpl中的getOrderRecordByOrderID方法 |

| RecordsController.getOrderRecordByUserID | 语法     | public ResponseVO getOrderRecordByUserID(int userID)         |
| ---------------------------------------- | -------- | ------------------------------------------------------------ |
|                                          | 前置条件 | 已创建一个RecordsServiceImpl领域对象                         |
|                                          | 后置条件 | 通过接口调用RecordsServiceImpl中的getOrderRecordWithUserID方法 |

##### RecordsServiceImpl的接口

| RecordsServiceImpl.getChargeRecords | 语法     | public ResponseVO getChargeRecords() |
| ----------------------------------- | -------- | ------------------------------------ |
|                                     | 前置条件 | 启动一个充值记录查询                 |
|                                     | 后置条件 | 返回所有充值记录                     |

| RecordsServiceImpl.getChargeRecordsById | 语法     | public ResponseVO getChargeRecordsById(int recordId) |
| --------------------------------------- | -------- | ---------------------------------------------------- |
|                                         | 前置条件 | 启动一个充值记录查询                                 |
|                                         | 后置条件 | 返回对应序号的充值记录                               |

| RecordsServiceImpl.getChargeRecordsByUserID | 语法     | public ResponseVO getChargeRecordsByUserID(int userID) |
| ------------------------------------------- | -------- | ------------------------------------------------------ |
|                                             | 前置条件 | 启动一个充值记录查询，且会员已经登录                   |
|                                             | 后置条件 | 返回用户所有的充值记录                                 |

| RecordsServiceImpl.getAllComsumptionRecords | 语法     | public ResponseVO getAllComsumptionRecords() |
| ------------------------------------------- | -------- | -------------------------------------------- |
|                                             | 前置条件 | 启动一个消费记录查询                         |
|                                             | 后置条件 | 返回所有的消费记录（消费记录以票为单位）     |

| RecordsServiceImpl.getComRecordsByOrderID | 语法     | public ResponseVO getComRecordsByOrderID(int orderID) |
| ----------------------------------------- | -------- | ----------------------------------------------------- |
|                                           | 前置条件 | 启动一个消费记录查询                                  |
|                                           | 后置条件 | 返回对应序号的消费记录                                |

| RecordsServiceImpl.getComRecordsByUserID | 语法     | public ResponseVO getComRecordsByUserID(int userID) |
| ---------------------------------------- | -------- | --------------------------------------------------- |
|                                          | 前置条件 | 启动一个消费记录查询且用户已登录                    |
|                                          | 后置条件 | 返回对应用户的消费记录                              |

| RecordsServiceImpl.getComsumptionRecordByTicketID | 语法     | public ComsumptionRecord getComsumptionRecordByTicketID(int ticketID) |
| ------------------------------------------------- | -------- | ------------------------------------------------------------ |
|                                                   | 前置条件 | 启动一个消费记录查询且用户已登录                             |
|                                                   | 后置条件 | 返回对应票号的消费记录                                       |

| RecordsServiceImpl.getOrderRecordByOrderID | 语法     | public ResponseVO getOrderRecordByOrderID(int orderID) |
| ------------------------------------------ | -------- | ------------------------------------------------------ |
|                                            | 前置条件 | 启动一个订单记录查询                                   |
|                                            | 后置条件 | 返回对应订单号的订单记录                               |

| RecordsServiceImpl.getOrderRecordWithUserID | 语法     | public ResponseVO getOrderRecordWithUserID(int userID) |
| ------------------------------------------- | -------- | ------------------------------------------------------ |
|                                             | 前置条件 | 启动一个订单记录查询且用户以登录                       |
|                                             | 后置条件 | 返回对应用户的订单记录                                 |

### 5.依赖视角

参见软件结构说明文档中的包图